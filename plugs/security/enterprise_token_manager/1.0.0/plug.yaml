actions:
- generate_token_pair
- validate_token
- rotate_refresh_token
- revoke_token
- get_public_key
- bulk_revoke_user_tokens
- audit_token_usage
author: PlugPipe Security Team
business_value:
  competitive_advantages:
  - Industry-leading 2024 JWT security standards implementation
  - Zero-downtime token revocation with Redis+Database architecture
  - Risk-based adaptive security reduces breach impact by 60%
  - Enterprise-grade compliance with Auth0/Okta/AWS standards
  - Plugin-based architecture enables rapid integration with any identity provider
  operational_benefits:
  - One-click integration with existing enterprise identity systems
  - Automated token lifecycle management reduces operational overhead
  - High-availability architecture ensures authentication system resilience
  - Comprehensive monitoring provides real-time security insights
  - Plugin composition allows customization without code changes
  security_benefits:
  - Eliminates token-based security vulnerabilities through mandatory rotation
  - Reduces authentication attack surface with short-lived tokens
  - Provides durable token revocation immune to Redis failures
  - Implements comprehensive audit trail for compliance requirements
  - Enables risk-based access control with dynamic token adjustment
category: token_management
compliance_standards:
- Auth0 2024 Best Practices
- Okta Enterprise Security Standards
- AWS Cognito Security Model
- RFC 7519 (JWT)
- RFC 7515 (JWS)
- Industry JWT Security Guidelines
configuration:
- default: 15
  description: Access token expiration in minutes (industry standard 15 min)
  maximum: 60
  minimum: 5
  name: access_token_minutes
  required: false
  type: integer
- default: 7
  description: Refresh token expiration in days (enterprise standard 7 days)
  maximum: 30
  minimum: 1
  name: refresh_token_days
  required: false
  type: integer
- default: 90
  description: API token maximum expiration in days (security limit 90 days)
  maximum: 90
  minimum: 1
  name: api_token_days
  required: false
  type: integer
- description: JWT issuer claim (must be explicitly configured for security)
  example: plugpipe.enterprise.com
  name: issuer
  required: true
  secure: false
  type: string
- description: JWT audience claim (must be explicitly configured for security)
  example: plugpipe-api-v2
  name: audience
  required: true
  secure: false
  type: string
- description: RSA private key for token signing (PEM format, 4096-bit recommended)
  name: private_key
  required: false
  secure: true
  type: string
- description: RSA public key for token validation (PEM format)
  name: public_key
  required: false
  secure: false
  type: string
- default: true
  description: Enforce mandatory refresh token rotation (security requirement)
  name: require_rotation
  required: false
  type: boolean
- default: 50
  description: Maximum refresh token rotations to prevent infinite chains
  maximum: 100
  minimum: 1
  name: max_refresh_uses
  required: false
  type: integer
- default: true
  description: Enable risk-based dynamic token expiration adjustment
  name: risk_based_expiration
  required: false
  type: boolean
- default: true
  description: Require explicit issuer/audience configuration (security control)
  name: enforce_issuer_audience
  required: false
  type: boolean
dependencies:
  plugins:
  - data/database_operations (fallback storage)
  - monitoring/prometheus_metrics (optional)
  - logging/audit_logger (optional)
  python:
  - PyJWT>=2.8.0
  - authlib>=1.6.0
  - cryptography>=41.0.0
  - redis>=4.5.0
  - asyncio>=3.4.3
  system:
  - redis-server (with persistence enabled)
description: Enterprise-grade JWT token security manager implementing 2024 industry
  best practices from Auth0, Okta, AWS Cognito with mandatory rotation, durable revocation,
  and risk-based expiration
discoverability: public
documentation:
  api_reference: docs/enterprise-token-api.md
  configuration_guide: docs/enterprise-token-config.md
  integration_guide: docs/enterprise-token-integration.md
  security_guide: docs/enterprise-token-security.md
  setup_guide: docs/enterprise-token-setup.md
  troubleshooting: docs/enterprise-token-troubleshooting.md
enterprise_integrations:
  identity_providers:
  - Auth0 (complete compatibility)
  - Okta (enterprise SSO integration)
  - AWS Cognito (cloud-native deployment)
  - KeyCloak (open-source enterprise)
  - Azure AD (Microsoft enterprise)
  monitoring_integrations:
  - Prometheus metrics export
  - Grafana dashboard templates
  - ELK stack log integration
  - DataDog APM integration
  storage_backends:
  - Redis (primary, high-performance revocation)
  - PostgreSQL (durable fallback storage)
  - MySQL (enterprise database integration)
  - MongoDB (document-based metadata storage)
entrypoint: main.py
external_dependencies:
  install_method: pip
  packages:
  - PyJWT
  - redis
  - authlib
  - secrets
  - cryptography
  requirements_file: requirements.txt
homepage: https://plugpipe.dev/plugs/enterprise-token-manager
input_schema:
  properties:
    action:
      description: Token management operation to perform
      enum:
      - generate_token_pair
      - validate_token
      - rotate_refresh_token
      - revoke_token
      - get_public_key
      type: string
    refresh_token:
      description: Refresh token for rotation operation
      type: string
    token:
      description: JWT token for validation or revocation
      type: string
    token_type:
      default: access
      description: Type of token for validation
      enum:
      - access
      - refresh
      - api
      type: string
    user_id:
      description: User identifier for token generation
      type: string
  required:
  - action
  type: object
license: MIT
monitoring:
  audit_logging:
  - All token lifecycle events
  - Risk score calculations
  - Revocation store operations
  - Security policy violations
  - Enterprise compliance events
  events:
  - token_generated
  - token_validated
  - token_rotation_completed
  - token_revoked
  - token_validation_failed
  - risk_score_calculated
  - revocation_store_fallback
  metrics:
  - enterprise_tokens_generated_total
  - enterprise_tokens_validated_total
  - enterprise_token_validation_failures_total
  - enterprise_tokens_revoked_total
  - enterprise_token_rotation_total
  - enterprise_token_risk_scores
  - redis_revocation_store_hits
  - database_fallback_usage
name: enterprise_token_manager
display_name: EnterpriseTokenManager
output_schema:
  properties:
    access_token:
      description: Generated access token (JWT)
      type: string
    error:
      description: Error message if operation failed
      type: string
    expires_in:
      description: Access token expiration time in seconds
      type: integer
    permissions:
      description: User permissions from validated token
      items:
        type: string
      type: array
    refresh_token:
      description: Generated refresh token (JWT)
      type: string
    risk_score:
      description: Calculated risk score for the token
      type: number
    success:
      description: Operation success status
      type: boolean
    token_type:
      description: Token type (typically "Bearer")
      type: string
    user_id:
      description: Validated user identifier
      type: string
  required:
  - success
  type: object
owner: PlugPipe Security Team
performance:
  cache_keys: true
  concurrent_operations: 1000
  priority: 15
  retries: 3
  timeout: 5
plugin_type: security
pure_orchestration: false
redis:
- default: redis://localhost:6379/0
  description: Redis connection URL for token revocation blacklist
  name: url
  required: false
  type: string
- default: true
  description: Require Redis disk persistence for production deployment
  name: persistence_required
  required: false
  type: boolean
reused_infrastructure:
- Redis for high-performance token revocation storage
- Enterprise database systems for durable fallback storage
- PyJWT and Authlib for cryptographically secure JWT operations
- PlugPipe plugin composition for identity provider integrations
- Standard enterprise monitoring and observability tools
- Existing audit logging and compliance reporting systems
revolutionary_capabilities:
- industry_leading_2024_jwt_security_standards
- mandatory_refresh_token_rotation_with_enterprise_controls
- redis_database_dual_revocation_architecture
- risk_based_adaptive_token_expiration_system
- comprehensive_audit_logging_enterprise_compliance
- plugin_composition_identity_provider_agnostic
- zero_downtime_token_lifecycle_management
- cryptographically_secure_4096_bit_key_management
sbom:
  complete: sbom/enterprise_token_manager-sbom-complete.json
  summary: sbom/enterprise_token_manager-sbom.json
security_features:
  cryptographic:
  - RS256 asymmetric signing with 4096-bit keys
  - Enterprise-grade key rotation support
  - JWK format for external validation
  - Cryptographically secure JTI generation
  enterprise_controls:
  - Configurable issuer/audience validation (required)
  - Comprehensive audit logging
  - Redis + Database durable revocation store
  - Rotation count limits prevent infinite chains
  - High-availability fallback mechanisms
  token_lifecycle:
  - Short-lived access tokens (15 min default)
  - Mandatory refresh token rotation
  - JTI-based revocation tracking
  - Risk-based dynamic token expiration
  - Automatic token cleanup with TTL
security_grade: enterprise
status: stable
testing:
  compliance_validation: true
  integration_tests: true
  performance_tests: true
  security_tests: true
  unit_tests: true
title: Enterprise Token Security Manager
token_policy:
  access_token_default: 15 minutes
  api_token_maximum: 90 days
  durable_revocation: true
  mandatory_rotation: true
  refresh_token_default: 7 days
  risk_based_expiration: true
type: security
universal_use_cases:
- enterprise_user_authentication_with_sso_integration
- microservices_api_authentication_and_authorization
- mobile_application_secure_token_management
- web_application_session_management_with_refresh_rotation
- service_to_service_authentication_with_jwt_bearer_tokens
- multi_tenant_saas_application_user_isolation
- compliance_heavy_industries_audit_trail_requirements
- high_security_environments_risk_based_access_control
version: 1.0.0
zero_business_logic_overlap: true
copyright:
  owner: PlugPipe Team
  year: 2025
  notice: Copyright Â© 2025 PlugPipe Team. All rights reserved.
license_url: https://opensource.org/licenses/MIT
spdx_license_identifier: MIT
